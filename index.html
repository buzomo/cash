<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ‘›</text></svg>" />
  <title>Money</title>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>è²¡å¸ƒã®ç¾é‡‘</h1>
      <button id="addButton" class="action-button">è¿½åŠ </button>
    </div>

    <div class="stats-container">
      <div class="balance-card">
        <div class="balance-title">æ®‹é«˜</div>
        <div id="currentBalance" class="balance-amount"></div>
      </div>

      <div class="period-stats">
        <div id="todayTab" class="stat-card period-tab">
          <div class="stat-title">ä»Šæ—¥</div>
          <div id="todaySpending" class="stat-amount"></div>
        </div>
        <div id="weekTab" class="stat-card period-tab active-tab">
          <div class="stat-title">ä»Šé€±</div>
          <div id="weekSpending" class="stat-amount"></div>
        </div>
        <div id="monthTab" class="stat-card period-tab">
          <div class="stat-title">ä»Šæœˆ</div>
          <div id="monthSpending" class="stat-amount"></div>
        </div>
      </div>

      <div class="chart-container">
        <canvas id="expenseChart"></canvas>
      </div>
    </div>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="æ¤œç´¢ï¼ˆå“åã€é‡‘é¡ã€æ—¥ä»˜ï¼‰" />
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>æ—¥ä»˜</th>
            <th>é‡‘é¡</th>
            <th>åç›®</th>
          </tr>
        </thead>
        <tbody id="transactionTable"></tbody>
      </table>
    </div>
  </div>

  <!-- è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="addModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>æ–°è¦å–å¼•ã®è¿½åŠ </h2>
      <div class="input-area">
        <input type="date" id="date" required />
        <input type="text" id="amount" placeholder="é‡‘é¡" required />
        <input type="text" id="description" placeholder="åç›®" required />
        <button class="add-button" id="submitAdd">è¿½åŠ </button>
      </div>
    </div>
  </div>

  <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>å–å¼•ã®ç·¨é›†</h2>
      <div class="input-area">
        <input type="date" id="editDate" required />
        <input type="text" id="editAmount" placeholder="é‡‘é¡" required />
        <input type="text" id="editDescription" placeholder="åç›®" required />
        <button class="update-button" id="submitUpdate">æ›´æ–°</button>
        <button class="delete-button" id="submitDelete">å‰Šé™¤</button>
      </div>
    </div>
  </div>

  <div id="toast"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script>
    let transactions = [];
    let currentRequest = null;
    let retryCount = 0;
    const maxRetries = 3;
    let currentEditIndex = null;
    let myChart = null;

    // DOMè¦ç´ ã®èª­ã¿è¾¼ã¿
    document.addEventListener('DOMContentLoaded', function () {
      // è¿½åŠ ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      document.getElementById('addButton').addEventListener('click', openAddModal);

      // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
      document.querySelectorAll('.close').forEach(closeBtn => {
        closeBtn.addEventListener('click', function () {
          document.querySelectorAll('.modal').forEach(modal => {
            modal.style.display = 'none';
          });
        });
      });

      // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
      window.addEventListener('click', function (event) {
        document.querySelectorAll('.modal').forEach(modal => {
          if (event.target === modal) {
            modal.style.display = 'none';
          }
        });
      });

      // è¿½åŠ ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      document.getElementById('submitAdd').addEventListener('click', addTransaction);

      // æ›´æ–°ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      document.getElementById('submitUpdate').addEventListener('click', updateTransaction);

      // å‰Šé™¤ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      document.getElementById('submitDelete').addEventListener('click', deleteTransaction);

      // æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      document.getElementById('searchInput').addEventListener('input', filterTransactions);

      // åˆæœŸæ—¥ä»˜è¨­å®š
      document.getElementById("date").value = new Date().toISOString().split("T")[0];

      // æœŸé–“ã‚¿ãƒ–ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ 
      document.getElementById('todayTab').addEventListener('click', function () {
        setActiveTab('today');
        updateChart('today');
      });

      document.getElementById('weekTab').addEventListener('click', function () {
        setActiveTab('week');
        updateChart('week');
      });

      document.getElementById('monthTab').addEventListener('click', function () {
        setActiveTab('month');
        updateChart('month');
      });

      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é€±ã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
      setActiveTab('week');
    });

    // ã‚¿ãƒ–ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’è¨­å®š
    function setActiveTab(activeTab) {
      const tabs = ['todayTab', 'weekTab', 'monthTab'];
      tabs.forEach(tab => {
        if (tab === activeTab + 'Tab') {
          document.getElementById(tab).classList.add('active-tab');
        } else {
          document.getElementById(tab).classList.remove('active-tab');
        }
      });
    }

    // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–¢æ•°ã‚’ä¿®æ­£
    function loadTransactions() {
      fetch('https://raw.githubusercontent.com/buzomo/cash-data/refs/heads/main/transactions.json')
        .then(response => response.json())
        .then(data => {
          transactions = data;
          updateTable();
          updateStats();
          updateChart('week'); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯é€±è¡¨ç¤º
        })
        .catch(error => console.error('Error loading transactions:', error));
    }

    // é‡‘é¡ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    function formatCurrency(amount) {
      return new Intl.NumberFormat("ja-JP", {
        style: "currency",
        currency: "JPY",
      }).format(amount);
    }

    // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
    function updateTable() {
      const tbody = document.getElementById("transactionTable");
      tbody.innerHTML = "";

      transactions
        .sort((a, b) => new Date(b.date) - new Date(a.date))
        .forEach((transaction, index) => {
          const row = tbody.insertRow();
          row.insertCell().textContent = transaction.date;
          row.insertCell().textContent = formatCurrency(transaction.amount);
          row.lastChild.className =
            transaction.amount >= 0 ? "amount-positive" : "amount-negative";
          row.insertCell().textContent = transaction.description;
          row.onclick = () => openEditModal(index);
        });

      updateStats();
    }

    // çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
    function updateStats() {
      // æ®‹é«˜
      const balance = transactions.reduce((sum, t) => sum + t.amount, 0);
      document.getElementById("currentBalance").textContent = formatCurrency(balance);

      // æ—¥ä»˜
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      const startOfWeek = new Date(today);
      startOfWeek.setDate(today.getDate() - today.getDay()); // æ—¥æ›œæ—¥ã‚’é€±ã®å§‹ã¾ã‚Šã¨ã™ã‚‹

      const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);

      // ä»Šæ—¥ã®æ”¯å‡º
      const todaySpending = transactions
        .filter(t => new Date(t.date).toDateString() === today.toDateString() && t.amount < 0)
        .reduce((sum, t) => sum + Math.abs(t.amount), 0);

      // ä»Šé€±ã®æ”¯å‡º
      const weekSpending = transactions
        .filter(t => new Date(t.date) >= startOfWeek && t.amount < 0)
        .reduce((sum, t) => sum + Math.abs(t.amount), 0);

      // ä»Šæœˆã®æ”¯å‡º
      const monthSpending = transactions
        .filter(t => new Date(t.date) >= startOfMonth && t.amount < 0)
        .reduce((sum, t) => sum + Math.abs(t.amount), 0);

      document.getElementById("todaySpending").textContent = formatCurrency(todaySpending);
      document.getElementById("weekSpending").textContent = formatCurrency(weekSpending);
      document.getElementById("monthSpending").textContent = formatCurrency(monthSpending);
    }

    // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
    function updateChart(period = 'week') {
      const ctx = document.getElementById('expenseChart').getContext('2d');

      // æ—¥ä»˜ã¨ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
      let labels = [];
      let expenseData = [];
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      if (period === 'today') {
        // ä»Šæ—¥ã®æ™‚é–“å¸¯åˆ¥ãƒ‡ãƒ¼ã‚¿ (6æ™‚é–“ã”ã¨)
        const timeSlots = ['0-6æ™‚', '6-12æ™‚', '12-18æ™‚', '18-24æ™‚'];

        labels = timeSlots;
        expenseData = timeSlots.map((_, index) => {
          const startHour = index * 6;
          const endHour = startHour + 6;

          return transactions
            .filter(t => {
              const txDate = new Date(t.date);
              return txDate.toDateString() === today.toDateString() &&
                t.amount < 0 &&
                txDate.getHours() >= startHour &&
                txDate.getHours() < endHour;
            })
            .reduce((sum, t) => sum + Math.abs(t.amount), 0);
        });
      }
      else if (period === 'week') {
        // é€±åˆ¥ãƒ‡ãƒ¼ã‚¿ (éå»4é€±é–“)
        for (let i = 3; i >= 0; i--) {
          const endDate = new Date(today);
          endDate.setDate(today.getDate() - (i * 7));

          const startDate = new Date(endDate);
          startDate.setDate(endDate.getDate() - 6);

          const weekLabel = `${startDate.getMonth() + 1}/${startDate.getDate()}-${endDate.getMonth() + 1}/${endDate.getDate()}`;
          labels.push(weekLabel);

          const weeklyExpense = transactions
            .filter(t => {
              const txDate = new Date(t.date);
              return txDate >= startDate && txDate <= endDate && t.amount < 0;
            })
            .reduce((sum, t) => sum + Math.abs(t.amount), 0);

          expenseData.push(weeklyExpense);
        }
      }
      else if (period === 'month') {
        // æœˆåˆ¥ãƒ‡ãƒ¼ã‚¿ (éå»6ãƒ¶æœˆ)
        for (let i = 5; i >= 0; i--) {
          const date = new Date(today.getFullYear(), today.getMonth() - i, 1);
          const monthLabel = `${date.getFullYear()}/${date.getMonth() + 1}`;
          labels.push(monthLabel);

          const startOfMonth = new Date(date.getFullYear(), date.getMonth(), 1);
          const endOfMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0);

          const monthlyExpense = transactions
            .filter(t => {
              const txDate = new Date(t.date);
              return txDate >= startOfMonth && txDate <= endOfMonth && t.amount < 0;
            })
            .reduce((sum, t) => sum + Math.abs(t.amount), 0);

          expenseData.push(monthlyExpense);
        }
      }

      // ãƒãƒ£ãƒ¼ãƒˆãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ç ´æ£„
      if (myChart) {
        myChart.destroy();
      }

      // æœŸé–“ã«å¿œã˜ãŸã‚¿ã‚¤ãƒˆãƒ«
      let chartTitle = '';
      switch (period) {
        case 'today':
          chartTitle = 'ä»Šæ—¥ã®æ™‚é–“å¸¯åˆ¥æ”¯å‡º';
          break;
        case 'week':
          chartTitle = 'é€±åˆ¥æ”¯å‡ºï¼ˆéå»4é€±é–“ï¼‰';
          break;
        case 'month':
          chartTitle = 'æœˆåˆ¥æ”¯å‡ºï¼ˆéå»6ãƒ¶æœˆï¼‰';
          break;
      }

      // æ–°ã—ã„ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆ
      myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: chartTitle,
            data: expenseData,
            backgroundColor: 'rgba(233, 30, 99, 0.7)',
            borderColor: 'rgba(233, 30, 99, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: chartTitle,
              font: {
                size: 16
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return 'Â¥' + value.toLocaleString();
                }
              }
            }
          }
        }
      });
    }
    // GitHubé€£æº
    async function pushToGitHub(content) {
      const controller = new AbortController();
      currentRequest = controller;

      try {
        const sha = await getFileSHA();
        const formattedContent = JSON.stringify(content, null, 2);
        const response = await fetch(
          'https://api.github.com/repos/buzomo/cash-data/contents/transactions.json',
          {
            method: 'PUT',
            headers: {
              'Authorization': `token ${getLocalStorageToken('gh_token')}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              message: `Auto-save ${new Date().toISOString()}`,
              content: base64EncodeUnicode(formattedContent),
              sha: sha
            }),
            signal: controller.signal
          }
        );

        if (response.status === 409) {
          throw new Error('sha mismatch');
        }

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message);
        }

        retryCount = 0;
        return true;
      } catch (error) {
        if (error.name === 'AbortError') return;
        throw error;
      } finally {
        currentRequest = null;
      }
    }

    async function autoSave(content) {
      try {
        await pushToGitHub(content);
        return true;
      } catch (error) {
        if (error.message === 'sha mismatch' && retryCount < maxRetries) {
          retryCount++;
          return autoSave(content);
        }
        return false;
      }
    }

    // è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openAddModal() {
      document.getElementById("date").value = new Date().toISOString().split("T")[0];
      document.getElementById("amount").value = "";
      document.getElementById("description").value = "";
      document.getElementById("addModal").style.display = "block";
    }

    // ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openEditModal(index) {
      currentEditIndex = index;
      const transaction = transactions[index];
      document.getElementById("editDate").value = transaction.date;
      document.getElementById("editAmount").value = transaction.amount;
      document.getElementById("editDescription").value = transaction.description;
      document.getElementById("editModal").style.display = "block";
    }

    // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ 
    function addTransaction() {
      const date = document.getElementById("date").value;
      let amount = document.getElementById("amount").value.replace(/[,Â¥]/g, "");
      const description = document.getElementById("description").value;

      if (date && !isNaN(parseFloat(amount)) && description) {
        if (!amount.startsWith('+')) {
          amount = -Math.abs(parseFloat(amount));
        } else {
          amount = parseFloat(amount);
        }
        transactions.push({ date, amount, description });
        updateTable();
        document.getElementById("addModal").style.display = "none";
        updateChart();
        autoSave(transactions).then(success => {
          if (success) {
            showToast("ãƒ‡ãƒ¼ã‚¿ãŒGitHubã«ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼");
          } else {
            showToast("ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
          }
        });
      } else {
        alert("æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„");
      }
    }

    // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ›´æ–°
    function updateTransaction() {
      const date = document.getElementById("editDate").value;
      let amount = document.getElementById("editAmount").value.replace(/[,Â¥]/g, "");
      const description = document.getElementById("editDescription").value;

      if (date && !isNaN(parseFloat(amount)) && description) {
        if (!amount.startsWith('+')) {
          amount = -Math.abs(parseFloat(amount));
        } else {
          amount = parseFloat(amount);
        }
        transactions[currentEditIndex] = { date, amount, description };
        updateTable();
        document.getElementById("editModal").style.display = "none";
        updateChart();
        autoSave(transactions).then(success => {
          if (success) {
            showToast("ãƒ‡ãƒ¼ã‚¿ãŒGitHubã«ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼");
          } else {
            showToast("ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
          }
        });
      } else {
        alert("æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„");
      }
    }

    // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‰Šé™¤
    function deleteTransaction() {
      transactions.splice(currentEditIndex, 1);
      updateTable();
      document.getElementById("editModal").style.display = "none";
      updateChart();
      autoSave(transactions).then(success => {
        if (success) {
          showToast("ãƒ‡ãƒ¼ã‚¿ãŒGitHubã«ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼");
        } else {
          showToast("ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
        }
      });
    }

    // ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤º
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;
      toast.classList.add("show");

      setTimeout(() => {
        toast.classList.remove("show");
      }, 1000);
    }

    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
    function getLocalStorageToken(key) {
      return localStorage.getItem(key);
    }

    // Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
    function base64EncodeUnicode(str) {
      return btoa(unescape(encodeURIComponent(str)));
    }

    // ãƒ•ã‚¡ã‚¤ãƒ«SHAå–å¾—
    async function getFileSHA() {
      const response = await fetch('https://api.github.com/repos/buzomo/cash-data/contents/transactions.json', {
        headers: {
          'Authorization': `token ${getLocalStorageToken('gh_token')}`
        }
      });
      const data = await response.json();
      return data.sha;
    }

    // æ¤œç´¢æ©Ÿèƒ½
    function filterTransactions() {
      const searchText = document.getElementById("searchInput").value.toLowerCase();
      const tbody = document.getElementById("transactionTable");
      tbody.innerHTML = "";

      transactions
        .sort((a, b) => new Date(b.date) - new Date(a.date))
        .filter(transaction => {
          return (
            transaction.description.toLowerCase().includes(searchText) ||
            transaction.date.includes(searchText) ||
            transaction.amount.toString().includes(searchText)
          );
        })
        .forEach((transaction, index) => {
          const row = tbody.insertRow();
          row.insertCell().textContent = transaction.date;
          row.insertCell().textContent = formatCurrency(transaction.amount);
          row.lastChild.className =
            transaction.amount >= 0 ? "amount-positive" : "amount-negative";
          row.insertCell().textContent = transaction.description;
          // ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä¿å­˜
          row.dataset.index = transactions.indexOf(transaction);
          row.onclick = () => openEditModal(row.dataset.index);
        });
    }

    // ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼
    document.addEventListener("keydown", function (e) {
      if (e.altKey && e.key === "s") {
        e.preventDefault();

        const transactionsData = `let transactions = ${JSON.stringify(
          transactions,
          null,
          4
        )};`;

        navigator.clipboard
          .writeText(transactionsData)
          .then(() => {
            showToast(
              "æœ€æ–°ã® transactions ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼"
            );
          })
          .catch((err) => {
            showToast("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: " + err);
          });
        setTimeout(() => {
          location.href =
            "https://github.com/buzomo/toh-cash/edit/main/index.html";
        }, 3000);
      }
    });
  </script>
</body>
<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: sans-serif;
    background-color: #f8e1e1;
    color: #333;
  }

  .container {
    max-width: 100%;
    padding: 10px;
    margin: 0 auto;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding: 10px 0;
  }

  h1 {
    font-size: 1.8rem;
    color: #e91e63;
    margin: 0;
  }

  .action-button {
    background-color: #e91e63;
    color: white;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
  }

  .action-button::after {
    content: "+";
  }

  .action-button:hover {
    background-color: #d81b60;
  }

  .stats-container {
    margin-bottom: 20px;
  }

  .balance-card {
    background-color: #ffeef2;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 15px;
    text-align: center;
  }

  .balance-title {
    font-size: 1rem;
    color: #666;
  }

  .balance-amount {
    font-size: 1.8rem;
    font-weight: bold;
    color: #e91e63;
  }

  .period-stats {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    margin-bottom: 15px;
  }

  /* æœŸé–“ã‚¿ãƒ–ã®ã‚¹ã‚¿ã‚¤ãƒ« */
  .period-tab {
    cursor: pointer;
    transition: all 0.3s ease;
    border-bottom: 3px solid transparent;
  }

  .period-tab:hover {
    background-color: #fff5f8;
  }

  .active-tab {
    border-bottom: 3px solid #e91e63;
    background-color: #ffeef2;
  }

  .period-tab.active-tab .stat-title {
    color: #e91e63;
    font-weight: bold;
  }

  .stat-card {
    flex: 1;
    background-color: #fff;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  .stat-title {
    font-size: 0.8rem;
    color: #666;
    margin-bottom: 5px;
  }

  .stat-amount {
    font-size: 1.2rem;
    font-weight: bold;
    color: #c0392b;
  }

  .chart-container {
    background-color: #fff;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 15px;
    height: 200px;
  }

  .search-container {
    margin-bottom: 15px;
  }

  .search-container input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
  }

  .table-container {
    overflow-x: auto;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th,
  td {
    padding: 12px 10px;
    text-align: left;
    border-bottom: 1px solid #f2d7d9;
  }

  th {
    background-color: #e91e63;
    color: white;
    font-weight: 600;
    position: sticky;
    top: 0;
  }

  tbody tr {
    cursor: pointer;
    transition: background-color 0.2s;
  }

  tbody tr:hover {
    background-color: #fff5f8;
  }

  .amount-positive {
    color: #27ae60;
  }

  .amount-negative {
    color: #c0392b;
  }

  /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 500px;
    position: relative;
    animation: slideIn 0.3s ease;
  }

  @keyframes slideIn {
    from {
      transform: translateY(20px);
      opacity: 0;
    }

    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .close {
    position: absolute;
    top: 10px;
    right: 20px;
    color: #aaa;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  .close:hover {
    color: #e91e63;
  }

  h2 {
    margin-bottom: 20px;
    color: #e91e63;
    font-size: 1.5rem;
  }

  .input-area {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .input-area input {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 1rem;
  }

  .input-area button {
    padding: 12px;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s;
  }

  .add-button {
    background-color: #e91e63;
    color: white;
  }

  .add-button:hover {
    background-color: #d81b60;
  }

  .update-button {
    background-color: #4CAF50;
    color: white;
  }

  .update-button:hover {
    background-color: #45a049;
  }

  .delete-button {
    background-color: #f44336;
    color: white;
  }

  .delete-button:hover {
    background-color: #e53935;
  }

  #toast {
    visibility: hidden;
    width: 90%;
    max-width: 300px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 25px;
    padding: 12px;
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    bottom: 30px;
    font-size: 1rem;
    z-index: 2000;
    opacity: 0;
    transition: opacity 0.5s, visibility 0.5s;
  }

  #toast.show {
    visibility: visible;
    opacity: 1;
  }

  /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
  @media (min-width: 768px) {
    .container {
      max-width: 800px;
      padding: 20px;
    }

    h1 {
      font-size: 2.2rem;
    }

    .period-stats {
      gap: 15px;
    }

    .stat-title {
      font-size: 1rem;
    }

    .stat-amount {
      font-size: 1.5rem;
    }

    .chart-container {
      height: 250px;
    }

    .modal-content {
      width: 60%;
      margin: 10% auto;
    }
  }
</style>

</html>